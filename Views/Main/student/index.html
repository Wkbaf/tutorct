
<!-- uikit -->
<!-- <link rel="stylesheet" href="assets/plugin/mailbox/bower_components/uikit/css/uikit.almost-flat.min.css" media="all"> -->
<div id="loader-wrapper" ng-show="loader" ng-init="timeloader()">
    <div id="loader"></div>

    <div class="loader-section section-left"></div>
    <div class="loader-section section-right"></div>

</div>

<section class="main-content" ng-controller="StudentController" ng-init="checkLogin()">
    <div class="page-title P30">
        <h2 class="fl-l">Bảng điều khiển</h2>
    </div>
     <div class="row matchHeight-container">
        <div class="info-container" >
            <div class="col-sm-3 col-md-3" ng-init="loadLeftStudent(current_user)"><!--left col-->

          <ul class="list-group">
            <li class="list-group-item text-muted">Thông tin cơ bản</li>
            <li class="list-group-item text-right"><span class="pull-left"><strong>Tên</strong></span> {{leftProfile.fullname}}</li>
            <li class="list-group-item text-right"><span class="pull-left"><strong>Tham gia ngày</strong></span>{{leftProfile.created_at | date:'dd-MM-yyyy'}} </li>
            <!-- <li class="list-group-item text-right"><span class="pull-left"><strong>Số điểm đánh giá</strong></span> ??</li> -->
          </ul>

          <ul class="list-group" ng-init="listClass(current_user)">
            <li class="list-group-item text-muted">Các lớp đã đăng kí<span class="pull-right"></span></li>
            <li class="list-group-item" ng-repeat="lop in listClassOfStudent" style="display: inline-block;">
                <strong class="pull-left" style="word-wrap: break-word;width: 65%">
                    {{lop.giasu.thayco == 'thầy' ? 'Thầy' : 'Cô'}}&nbsp;{{lop.giasu.hoten | limitTo: 50}}&nbsp;({{lop.monhoc}})
                </strong>
                <!-- {{lop.thongbao.length}} -->
                <a class="glyphicon glyphicon-eye-open pull-right" ng-click="viewClass(lop)" href="#fullclass" uk-toggle title="Xem thông tin chi tiết lớp học" uk-tooltip></a>
                <a class="glyphicon glyphicon-star pull-right" ng-click="rateClassId(lop._id)" href="#modal-sections" uk-toggle title="Đánh giá lớp học" uk-tooltip></a>
                <a class="glyphicon glyphicon-bullhorn pull-right" ng-click="viewThongBao(lop._id)" href="#fullthongbao" uk-toggle title="Xem thông báo của gia sư" uk-tooltip></a>
                <a class=" glyphicon glyphicon-user pull-right" ng-click="viewDanhsachHS(lop)"  title="Xem danh sách học sinh"  uk-tooltip></a>
            </li>
          </ul>

          <ul class="list-group" ng-init="listFeed(current_user)">
            <li class="list-group-item text-muted">Các nhu cầu học<span class="pull-right">{{feedbacks.length}}</span></li>
            <li class="list-group-item" ng-repeat="feed in loadfeed">
                <strong>
                    {{feed.subject}}<span class="glyphicon glyphicon-trash pull-right" ng-click="deleteFeed(feed._id, feed.subject, $index, currentPage)"></span> &nbsp; <span class="pull-right">{{feed.created_at | date:'dd-MM-yyyy'}}</span>

                </strong>
            </li>
            <li>
            <pagination
            boundary-links="true"
            max-size="1"
            items-per-page="itemsFeedbackPerPage"
            total-items="feedbacks.length"
            ng-model="currentPage"
            ng-change="pageChanged(feedbacks, itemsFeedbackPerPage, 4)">
            </pagination>
            </li>
          </ul>

          <ul class="list-group">
            <li class="list-group-item text-muted">Cập nhật khác</li>
            <li class="list-group-item"><strong><a href="#offcanvas-push" uk-toggle="target: #offcanvas-push">Đăng kí nhu cầu học</a></strong></li>
            <li class="list-group-item"><strong><a href="#updatePro" uk-toggle="target: #updatePro">Cập nhật môn học</a></strong></li>
          </ul>


        </div><!--/col-3-->
        <div class="col-sm-9 col-md-9" id="mobieDash">
            <!-- <div ng-hide="user.active">
                <div class="alert alert-danger" style="margin-top: 10px">
                    <p>Tài khoản của bạn chưa được xác nhận.
                    Click vào link trong email để xác nhận</p>
                    <a href="#/student/resendactive" class="hoverLink">Gửi lại link active</a>
                </div>
            </div> -->
          <ul class="nav nav-tabs" id="myTab">
            <li class="active"><a data-target='#home' data-toggle="tab">Gia sư</a></li>
            <li>
                <a data-target='#message' data-toggle="tab">Liên lạc &nbsp;<span class="uk-badge">{{mailboxf.length}}</span></a>
            </li>
            <li><a data-target='#settings' data-toggle="tab">Thông tin chung</a></li>
            <li><a data-target='#accounts' data-toggle="tab">Tài khoản</a></li>
            <li><a data-target='#avatar' data-toggle="tab">Ảnh đại diện</a></li>
            <li ng-hide="dsHS"><a data-target='#danhsachHocsinh' data-toggle="tab">Danh sách học sinh</a></li>
          </ul>

          <div class="tab-content" >
            <div class="tab-pane active" id="home">
            <div class="list-group-item text-muted">Những Gia sư đã liên lạc</div>
                <div class="padding">
                    <div class="row row-sm" ng-init="tutorAccept(current_user)">
                        <div class="col-xs-12 col-md-6 uk-inline" ng-repeat="tutorA in tutorAccepted">
                            <div class="list-item r m-b tutor" >
                                <a herf="#" class="list-left">
                                    <span class="w-40 avatar">
                                        <img ng-src="/upload/{{tutorA.user.avatar}}" ng-hide="thumbnail.dataUrl">
                                        <div ng-if="thumbnail.dataUrl">
                                            <img ng-src="{{thumbnail.dataUrl}}">
                                        </div>
                                    </span>
                                </a>
                                <div class="list-body">
                                    <div class="text-ellipsis">
                                    <a style="text-transform: uppercase;">{{tutorA.value.giasu.gs_hoten}}
                                        <span>
                                            <a href="" class="glyphicon glyphicon-trash pull-right" ng-click="releaseTutor(tutorA.value.giasu.gs_username,current_user)" title="Xóa gia sư" uk-tooltip></a>
                                        </span>
                                        <span>
                                            <a class="glyphicon glyphicon-comment pull-right" href="#offcanvas-flip" uk-toggle="target: #offcanvas-flip" ng-click="loadChat(tutorA.value.giasu.gs_username)" title="Chat với gia sư" uk-tooltip></a>
                                        </span>
                                        <span>
                                            <a class="glyphicon glyphicon-eye-open pull-right" href="#modal-full" ng-click="viewTutor(tutorA.value.giasu.gs_username,tutorA.user.avatar)" uk-toggle title="Xem thông tin chi tiết gia sư" uk-tooltip>
                                            </a>
                                        </span>

                                    </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

<!-- for modal view tutor -->
                    <div style="z-index: 2000" id="modal-full" class="uk-modal-full uk-animation-slide-bottom" uk-modal>
                        <div class="uk-modal-dialog">
                            <div class="uk-grid-collapse uk-child-width-1-2@s uk-flex-middle" uk-grid>
                                <div class="uk-background-cover" uk-height-viewport >
                                    <div class="uk-overflow-hidden">
                                         <img ng-src="/upload/{{tutorAvatar}}" ng-hide="thumbnail.dataUrl" class="uk-background-cover" uk-height-viewport>
                                    </div>
                                    <div ng-if="thumbnail.dataUrl">
                                        <img ng-src="{{thumbnail.dataUrl}}" class="uk-background-cover" uk-height-viewport>
                                    </div>
                                </div>
                                <div class="uk-padding-large info-item box P30 bg-7 corner">
                                    <h1 ng-if="tutor.thayco == 'thầy'">Thầy {{tutor.hoten}}</h1>
                                    <h1 ng-if="tutor.thayco == 'cô'">Cô {{tutor.hoten}}</h1>
                                    <hr class="uk-divider-icon">
                                    <a href="" class="glyphicon glyphicon-star pull-right"  ng-click="rateFunction(current_user, tutor.username)">
                                    </a>
                                    <br>
                                    <form id="contact_form" name="contact_form" class="info-form" >
                                        <div ng-init="khanang =0; tinhthan=0; phuongphap=0; tucach=0; avergate=1; avergateTotal=0; b =0">
                                        <div ng-repeat="x in lop">
                                        <span ng-init="$parent.khanang = khanang "></span>p{{khanang}}
                                                <span ng-init="$parent.tinhthan = tinhthan "></span>{{tinhthan}}
                                                <span ng-init="$parent.phuongphap = phuongphap"></span>{{phuongphap}}
                                                <span ng-init="$parent.tucach = tucach "></span>{{tucach}}
                                                <span ng-init="$parent.avergate = avergate"></span>
                                        <!-- Tính trung bình từng lớp -->
                                            <div ng-repeat="y in x.danhgia">
                                            <span ng-init="$parent.b = $parent.b+1"></span>
                                                <span ng-init="$parent.khanang = ($parent.khanang + y.khanang); "></span>{{khanang}}
                                                <span ng-init="$parent.tinhthan = ($parent.tinhthan + y.tinhthan); "></span>{{tinhthan}}
                                                <span ng-init="$parent.phuongphap = ($parent.phuongphap + y.phuongphap); "></span>{{phuongphap}}
                                                <span ng-init="$parent.tucach = ($parent.tucach + y.tucach); "></span>{{tucach}}
                                                <span ng-init="$parent.avergate = ($parent.khanang + $parent.tinhthan +$parent.phuongphap + $parent.tucach)/(4*x.danhgia.length)"></span>

                                            </div>{{avergate}}=
                                            <!-- Tính trung bình các lớp -->

<span ng-init="$parent.avergateTotal = ($parent.avergateTotal + avergate)"></span>lp{{avergateTotal}}
                                        </div>{{avergateTotal}}-{{avergate}}
                                            <!-- <div ng-repeat="x in tutor.danhgia | filter: query as count">
                                                <span ng-init="$parent.total = ($parent.total + x.rating); "></span>
                                                <span ng-init="$parent.counter = $parent.total / count.length"></span>
                                            </div> -->
                                            <!-- <span average-star-rating ng-model="counter" max="5"></span>({{counter}}) -->
                                          <!-- <span star-rating  ng-model="counter" max="5" readonly=true></span> -->
                                            <!-- <span class="stars alignright">
                                                <span ng-style="{ 'width': getStars(counter) }"></span>
                                            </span> -->
                                            <!-- <average-star-rating ng-model="counter" max="5"><average-star-rating> -->
                                        </div>

                                        <hr>
                                        <p>
                                           <strong>Ngày sinh:</strong> {{tutor.ngaysinh | date:'dd-MM-yyyy'}}
                                        </p>

                                        <p>
                                            <strong>Số điện thoại:</strong> {{tutor.sdt}}
                                        </p>

                                        <p>
                                            <strong>Nơi công tác:</strong> {{tutor.noicongtac}}
                                        </p>

                                        <p>
                                            <strong>Nơi có thể dạy:</strong> <span ng-repeat="x in tutor.noiday">{{x}}-</span>
                                        </p>

                                        <p>
                                            <strong>Kinh nghiệm giảng dạy:</strong> {{tutor.kinhnghiem}}
                                        </p>

                                        <p>
                                            <strong>Đang dạy môn:</strong> <span ng-repeat="x in tutor.daymon"><ng-letter-avatar data="{{x}}" title={{x}}></ng-letter-avatar>&nbsp;</span>
                                        </p>

                                        <p>
                                            <strong>Địa chỉ liên lạc:</strong> {{tutor.diachi}}
                                        </p>

                                    </form>
                                    <button class="uk-modal-close-full" type="button" uk-close>CLOSE</button>
                                </div>
                            </div>
                        </div>
                    </div>

<!-- for modal view student -->
                    <div style="z-index: 2000" id="modal-full-student" class="uk-modal-full uk-animation-slide-bottom" uk-modal>
                        <div class="uk-modal-dialog">
                            <div class="uk-grid-collapse uk-child-width-1-2@s uk-flex-middle" uk-grid>
                                <div class="uk-background-cover" uk-height-viewport >
                                    <div class="uk-overflow-hidden">
                                         <img ng-src="/upload/{{arrayHSUsername.user.avatar}}" ng-hide="thumbnail.dataUrl" class="uk-background-cover" uk-height-viewport>
                                    </div>
                                    <div ng-if="thumbnail.dataUrl">
                                        <img ng-src="{{thumbnail.dataUrl}}" class="uk-background-cover" uk-height-viewport>
                                    </div>
                                </div>
                                <div class="uk-padding-large info-item box P30 bg-7 corner">
                                    <form id="contact_form" name="contact_form" class="info-form" >
                                        <p>
                                           <strong>Ngày sinh:</strong> {{arrayHSUsername.hocsinh.ngaysinh | date:'dd-MM-yyyy'}}
                                        </p>

                                        <p>
                                            <strong>Số điện thoại:</strong> {{arrayHSUsername.hocsinh.phone}}
                                        </p>

                                        <p>
                                            <strong>Mô tả bản thân:</strong> {{arrayHSUsername.hocsinh.descr}}
                                        </p>

                                        <p>
                                            <strong>Châm ngôn sống:</strong> {{arrayHSUsername.hocsinh.quote}}
                                        </p>

                                    </form>
                                    <button class="uk-modal-close-full" type="button" uk-close>CLOSE</button>
                                </div>
                            </div>
                        </div>
                    </div>

<!-- modal view full class -->
                    <div style="z-index: 2000" id="fullclass" class="uk-modal-full uk-animation-slide-bottom" uk-modal>
                        <div class="uk-modal-dialog">
                            <div class="uk-grid-collapse uk-child-width-1-2@s uk-flex-middle" uk-grid>
                                <div class="uk-background-cover" uk-height-viewport  >
                                    <div class="uk-flex uk-height-1-1 uk-background-muted uk-margin uk-text-center">
                                        <div class="uk-margin-auto  uk-width-1s uk-card uk-card-default uk-card-body">
                                            <h3 style="text-align: center;">Thời Khóa Biểu</h3>
                                            <ul class="uk-list uk-list-striped">
                                                <li ng-repeat="x in classView.tkb">{{x.thu}}
                                                <span class="pull-right">Giờ kết thúc: {{x.giokt}}giờ:{{x.phutkt}}phút</span>
                                                <span class="pull-right">Giờ bắt đầu: {{x.giobd}}giờ:{{x.phutbd}}phút&nbsp;&nbsp;
                                                &nbsp;&nbsp;</span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="uk-padding-large info-item box P30 bg-7 corner">
                                    <h1 ng-if="tutor.thayco == 'thay'">Thầy {{tutor.hoten}}</h1>
                                    <h1 ng-if="tutor.thayco == 'co'">Cô {{tutor.hoten}}</h1>


                                    <form id="contact_form">
                                        <h3 style="text-align: center;">Thông tin lớp học</h3>
                                        <div ng-if="classView.danhgia.length!=0" ng-init="khanang =0; tinhthan=0; phuongphap=0; tucach=0; avergate=1">
                                            <div ng-repeat="x in classView.danhgia">
                                                <span ng-init="$parent.khanang = ($parent.khanang + x.khanang); "></span>
                                                <span ng-init="$parent.tinhthan = ($parent.tinhthan + x.tinhthan); "></span>
                                                <span ng-init="$parent.phuongphap = ($parent.phuongphap + x.phuongphap); "></span>
                                                <span ng-init="$parent.tucach = ($parent.tucach + x.tucach); "></span>
                                                <span ng-init="$parent.avergate = ($parent.khanang + $parent.tinhthan +$parent.phuongphap + $parent.tucach)/(4*classView.danhgia.length)"></span>
                                            </div>
                                            <div class="uk-inline">
                                                <span average-star-rating ng-model="avergate" max="5"></span>
                                                {{avergate | number : 1}} ({{classView.danhgia.length}} ratings) &nbsp;{{classView.hocsinh.length}} học sinh tham gia
                                                <div uk-dropdown="pos: right-center">
                                                    <ul class="uk-nav uk-dropdown-nav">
                                                        <li style="font-size: 16px" class="uk-active">Khả năng truyền đạt: <strong>{{khanang/classView.danhgia.length | number : 1}}</strong></li>
                                                        <li style="font-size: 16px" class="uk-active">Tinh thần trách nhiệm: <strong>{{tinhthan/classView.danhgia.length | number : 1}}</strong></li>
                                                        <li style="font-size: 16px" class="uk-active">Phương pháp, tổ chức dạy học: <strong>{{phuongphap/classView.danhgia.length | number : 1}}</strong></li>
                                                        <li style="font-size: 16px" class="uk-active">Tư cách, đạo đức: <strong>{{tucach/classView.danhgia.length | number : 1}}</strong></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div ng-if="classView.danhgia.length==0">Lớp này hiện chưa có đánh giá nào</div>
                                    <hr class="uk-divider-icon">
                                        <p>
                                           <strong>Học phí:</strong> {{classView.hocphi}}
                                        </p>

                                        <p>
                                            <strong>Nơi học:</strong> {{classView.noihoc}}
                                        </p>

                                        <p>
                                            <strong>Môn học:</strong> {{classView.monhoc}}
                                        </p>

                                        <h3 style="text-align: center;">Thông tin gia sư</h3>
                                    <hr class="uk-divider-icon">

                                        <p>
                                            <strong>Tên gia sư:</strong> {{classView.giasu.hoten}}
                                        </p>

                                        <p>
                                            <strong>Địa chỉ:</strong> {{classView.giasu.diachi}}
                                        </p>

                                        <p>
                                            <strong>Số điện thoại:</strong> {{classView.giasu.sdt}}
                                        </p>

                                    </form>
                                    <button class="uk-modal-close-full" type="button" uk-close>CLOSE</button>
                                </div>
                            </div>
                        </div>
                    </div>

<!-- modal view full thong bao -->
                    <div style="z-index: 2000" id="fullthongbao" class="uk-modal-full uk-animation-slide-bottom" uk-modal>
                        <div class="uk-modal-dialog" ng-init="comment=1">
                            <div class="uk-grid-collapse uk-child-width-1-2@s uk-flex-middle" uk-grid>
                                <div class="uk-background-cover" uk-height-viewport  >
                                    <div class="uk-flex uk-height-1-1 uk-background-muted uk-margin">
                                        <div class="uk-margin-auto  uk-width-1s uk-card uk-card-default uk-card-body">
                                        <button class="uk-modal-close-full" type="button" uk-close>CLOSE</button>
                                        <ul uk-tab>
                                            <li><a href="#" style="font-size: 1.875rem;" ng-click="viewThongBao(idLop)">THÔNG BÁO</a></li>
                                            <li><a href="#" style="font-size: 1.875rem;" ng-click="viewThaoluan(idLop)">THẢO LUẬN</a></li>
                                        </ul>
                                        <ul class="uk-switcher uk-margin">
                                            <li>
                                                <h3 ng-if="noThongbao" style="color: red">{{noThongbao}}</h3>
                                                <ul uk-accordion="collapsible: false">
                                                    <li ng-repeat="x in thongbaoView">
                                                        <h3 class="uk-accordion-title" ng-click="showComment(x)">
                                                            <b>{{x.topic}}</b>
                                                            <span class="pull-right">{{x.create_at | date:"MM/dd/yyyy 'at' h:mma"}}
                                                            </span>
                                                        </h3>
                                                        <div class="uk-accordion-content">
                                                            <p style="width: 98%;word-wrap: break-word;">{{x.noidung}}</p>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <!-- thảo luận -->
                                            <li>
                                                <h3 ng-if="noThaoluan" style="color: red">{{noThaoluan}}</h3>
                                                <ul uk-accordion="collapsible: false">
                                                    <li ng-repeat="x in thaoluanView">
                                                        <h3 class="uk-accordion-title" ng-click="showThaoluan(x)">
                                                            <b>{{x.topic}}</b>
                                                            <span class="pull-right">{{x.create_at | date:"MM/dd/yyyy 'at' h:mma"}}
                                                            </span>
                                                        </h3>
                                                        <div class="uk-accordion-content">
                                                            <p style="width: 98%;word-wrap: break-word;">{{x.content}}</p>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>


                                        </div>
                                    </div>
                                </div>
                                <div class="uk-padding-large uk-height-1-1" uk-height-viewport>
                                    <h3 ng-show="closeThaoluan" style="text-align: center;">Bình luận</h3>
                                    <h3 ng-hide="closeThaoluan" style="text-align: center;">Trả lời thảo luận</h3>
                                    <div style="height: 25vw !important; overflow: auto;">

                                        <article ng-repeat="x in thongbaoDon.comment" class="uk-comment uk-comment-primary">
                                            <header class="uk-comment-header uk-grid-medium uk-flex-middle" uk-grid>
                                                <div class="uk-width-auto">
                                                    <img class="uk-comment-avatar" src="/upload/{{x.avatar}}" width="80" height="80" alt="">
                                                </div>
                                                <!-- trường hợp thông báo -->
                                                <div ng-show="closeThaoluan" class="uk-width-expand">
                                                    <h4 class="uk-comment-title uk-margin-remove"><a class="uk-link-reset" href="#">{{x.user}}</a></h4>
                                                    <ul class="uk-comment-meta uk-subnav uk-subnav-divider uk-margin-remove-top">
                                                        <li>{{x.created | date:"MM/dd/yyyy 'at' h:mma"}}</li>
                                                    </ul>
                                                </div>
                                                <!-- trường họp thảo luận -->
                                                <div ng-hide="closeThaoluan" class="uk-width-expand">
                                                    <h4 class="uk-comment-title uk-margin-remove"><a class="uk-link-reset" href="#">{{x.respondent}}</a></h4>
                                                    <ul class="uk-comment-meta uk-subnav uk-subnav-divider uk-margin-remove-top">
                                                        <li>{{x.answer_date | date:"MM/dd/yyyy 'at' h:mma"}}</li>
                                                    </ul>
                                                </div>
                                            </header>
                                            <div class="uk-comment-body">
                                                <!-- trường hợp thông báo -->
                                                <p ng-show="closeThaoluan">{{x.content}}</p>
                                                <!-- trường hợp thảo luận -->
                                                <p ng-hide="closeThaoluan">{{x.answer}}</p>
                                            </div>
                                        </article>

                                    </div>

                                    <!-- trường hợp thông báo -->
                                    <article class="commentbox" ng-show="closeThaoluan">
                                        <header class="uk-comment-header uk-grid-medium uk-flex-middle" uk-grid>
                                            <div class="uk-width-expand">
                                                <textarea ng-model="content.comment" class="uk-textarea" rows="2" placeholder="Nhập bình luận của bạn">
                                                </textarea><br>
                                                <div class="uk-padding-small">
                                                    <button class="uk-button uk-button-secondary" ng-click="AddComment(thongbaoDon._id, current_user, current_role, user.avatar)">Đăng bình luận</button>
                                                </div>
                                            </div>
                                        </header>
                                    </article>
                                    <!-- trường hợp thảo luận -->
                                    <article class="commentbox" ng-hide="closeThaoluan">
                                        <header class="uk-comment-header uk-grid-medium uk-flex-middle" uk-grid>
                                            <div class="uk-width-expand">
                                                <textarea ng-model="traloi.thaoluan" class="uk-textarea" rows="2" placeholder="Nhập trả lời thảo luận">
                                                </textarea><br>
                                                <div class="uk-padding-small">
                                                    <button class="uk-button uk-button-secondary" ng-click="AddThaoluan(thongbaoDon.id, current_user, user.avatar)">Trả lời</button>
                                                </div>
                                            </div>
                                        </header>
                                    </article>

                                </div>
                            </div>
                        </div>
                    </div>
 <!-- Khung Chat với gia sư-->
                    <div id="offcanvas-flip" uk-offcanvas="flip: true" >
                        <div class="uk-offcanvas-bar">
                            <div >
                                <div>
                                    <div class="panel-heading">
                                        <span class="glyphicon glyphicon-comment"></span> Chat
                                    </div>
                                    <div class="panel-body chatbody">
                                        <ul class="chat">
                                            <li class="left clearfix" ng-repeat="chatMessage in chatMessages" >
                                                <!-- nếu bằng current_user định dạng bên trái ngược lại bên phải -->
                                                <div class="chat-body clearfix" ng-if="chatMessage.name==current_user">
                                                    <div class="header">
                                                        <strong class="primary-font uk-label uk-label-success">{{chatMessage.name}}</strong> <small class="pull-right text-muted">
                                                            <span class="glyphicon glyphicon-time"></span>{{chatMessage.createdAt | date: 'yyyy-MM-dd'}}</small>
                                                    </div>
                                                    <p>
                                                        {{chatMessage.message}}
                                                    </p>
                                                </div>
                                                <div class="chat-body clearfix" ng-if="chatMessage.name!=current_user">
                                                    <div class="header">
                                                        <small class=" text-muted"><span class="glyphicon glyphicon-time"></span>{{chatMessage.createdAt | date: 'yyyy-MM-dd'}}</small>
                                                        <strong class="pull-right primary-font uk-label uk-label-danger">{{chatMessage.name}}</strong>
                                                    </div>
                                                    <p>
                                                        {{chatMessage.message}}
                                                    </p>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="panel-footer">
                                        <div class="input-group">
                                            <input id="btn-input" type="text" class="form-control input-sm" ng-model="chatMes" placeholder="Type your message here..." />
                                            <span class="input-group-btn">
                                                <button ng-click="sendChat()" class="btn btn-warning btn-sm" id="btn-chat">
                                                    Send</button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button class="uk-button uk-button-default uk-offcanvas-close uk-width-1-1 uk-margin" type="button">Close</button>

                        </div>
                    </div>

<!-- đánh giá lớp học -->
                    <div id="modal-sections" uk-modal="center: true">
                        <div class="uk-modal-dialog">
                            <button class="uk-modal-close-default" type="button" uk-close></button>
                            <div class="uk-modal-header">
                                <h2 class="uk-modal-title">Đánh giá lớp học</h2>
                            </div>
                            <div class="uk-modal-body">
                                <form class="uk-form-horizontal uk-margin-large" ng-submit="rateClassFunction(current_user)">

                                    <div class="uk-margin">
                                        <label class="uk-form-label" style="font-size: 16px" for="form-horizontal-select">Khả năng truyền đạt:</label>
                                        <div class="uk-form-controls">
                                            <select ng-model="danhgia.khanang" class="uk-select " id="form-horizontal-select">
                                                <option ng-selected value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="uk-margin">
                                        <label class="uk-form-label" style="font-size: 16px" for="form-horizontal-select">Tinh thần trách nhiệm:</label>
                                        <div class="uk-form-controls">
                                            <select ng-model="danhgia.tinhthan" class="uk-select" id="form-horizontal-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="uk-margin">
                                        <label class="uk-form-label" style="font-size: 16px" for="form-horizontal-select">Phương pháp, tổ chức dạy học:</label>
                                        <div class="uk-form-controls">
                                            <select ng-model="danhgia.phuongphap" class="uk-select" id="form-horizontal-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="uk-margin">
                                        <label class="uk-form-label" style="font-size: 16px" for="form-horizontal-select">Tư cách, đạo đức:</label>
                                        <div class="uk-form-controls">
                                            <select ng-model="danhgia.tucach" class="uk-select" id="form-horizontal-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="uk-modal-footer uk-text-right">
                                        <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>
                                        <button class="uk-button uk-button-primary" type="submit">Save</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

             </div><!--/tab-pane-->
             <!-- mail box -->
             <div class="tab-pane"  id="message">
                <div class="list-group-item text-muted">
                <input class="uk-checkbox" type="checkbox" ng-init="mailOrSent = true" ng-click="mailOrSent = mailOrSent ? false : true">&nbsp; Liên lạc đã gửi
                    <!-- <button class="uk-button uk-button-primary glyphicon glyphicon-repeat  pull-right" ng-click="reloadMailbox(current_user)"></button> -->
                    <button class="uk-button uk-button-danger glyphicon glyphicon-trash pull-right" ng-click="deleteMailbox()"></button>
                </div>
                <div class="md-card-list-wrapper" id="mailbox" >
                    <!-- mail box -->
                    <div ng-show="mailOrSent" class="uk-width-large-9-10 uk-container-center" ng-init="mailStudent(current_user)" >
                        <div class="md-card-list" ng-repeat="mail in mailStudent | orderBy: '-value.created_at' ">
                            <ul class="hierarchical_slide">
                                <li>
                                    <span class="md-card-list-item-date">{{mail.value.created_at | date : 'dd-MM-yyyy:hh:mm'}}</span>
                                    <div class="md-card-list-item-select">
                                        <input class="uk-checkbox" type="checkbox" ng-model="mail.checked" ng-click="mailChecked(mail.value._id)">
                                    </div>
                                    <div class="md-card-list-item-avatar-wrapper">
                                        <span class="w-40 avatar">
                                          <!-- avatar default -->
                                            <img ng-src="/upload/{{mail.user.avatar}}" ng-hide="thumbnail.dataUrl">
                                            <!-- avatar upload if uploadavatar -->
                                            <div ng-if="thumbnail.dataUrl">
                                                <img ng-src="{{thumbnail.dataUrl}}">
                                            </div>
                                        </span>
                                    </div>
                                    <div class="md-card-list-item-sender">
                                        <span>From: {{mail.value.tutorname}}</span>
                                    </div>
                                    <div class="md-card-list-item-subject">
                                        <div class="md-card-list-item-sender-small">
                                            <span>From: {{mail.value.tutorname}}</span>
                                        </div>
                                        <span>{{mail.value.subject}}</span>
                                    </div>
                                    <div class="md-card-list-item-content-wrapper">
                                        <div class="md-card-list-item-content uk-text-justif">
                                            {{mail.value.message}}
                                            <hr class="uk-divider-icon" style="color: #576683">
                                        </div>
                                        <div class="row" ng-if="mail.value.accept==0">
                                            <div class="col-xs-6 col-md-6" style="text-align: center">
                                                <button class="uk-button uk-button-primary" ng-click="mailAccept(mail.value._id)">Accept</button>
                                            </div>
                                            <div class="col-xs-6 col-md-6" style="text-align: center">
                                                <button class="uk-button uk-button-danger" ng-click="mailDeny(mail.value._id)">Decide</button>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <pagination ng-show="mailOrSent"
                    boundary-links="true"
                    max-size="3"
                    items-per-page="itemsMailPerpage"
                    total-items="mailboxf.length"
                    ng-model="currentPage"
                    ng-change="pageChanged(mailboxf, itemsMailPerpage, 2)">
                    </pagination>
                    <!-- end mail -->
                    <!-- sent mail -->
                    <div ng-hide="mailOrSent" class="uk-width-large-9-10 uk-container-center" ng-init="sentmailStudent(current_user)" >
                        <div class="md-card-list" ng-repeat="mail in sentMailStudent">
                            <ul class="hierarchical_slide">
                                <li>
                                    <span class="md-card-list-item-date">{{mail.value.created_at | date : 'dd-MM-yyyy:hh:mm'}}</span>
                                    <div class="md-card-list-item-select">
                                        <input class="uk-checkbox" type="checkbox" ng-model="mail.checked" ng-click="mailChecked(mail.value._id)">
                                    </div>
                                    <div class="md-card-list-item-avatar-wrapper">
                                        <span class="w-40 avatar">
                                          <!-- avatar default -->
                                            <img ng-src="/upload/{{mail.user.avatar}}" ng-hide="thumbnail.dataUrl">
                                            <!-- avatar upload if uploadavatar -->
                                            <div ng-if="thumbnail.dataUrl">
                                                <img ng-src="{{thumbnail.dataUrl}}">
                                            </div>
                                        </span>
                                    </div>
                                    <div class="md-card-list-item-sender">
                                         <span>To: {{mail.tutor.hoten}}</span>
                                    </div>
                                    <div class="md-card-list-item-subject">
                                        <div class="md-card-list-item-sender-small">
                                            <span>To: {{mail.tutor.hoten}}</span>
                                        </div>
                                        <span>{{mail.value.nguyenvong}}</span>
                                    </div>
                                    <div class="md-card-list-item-content-wrapper">
                                        <div class="md-card-list-item-content uk-text-justif">
                                            <p>
                                                <h4>Thông tin liên lạc:</h4> <br>
                                                Môn học mong muốn: {{mail.value.monhoc}}<br>
                                                Nguyện vọng: {{mail.value.nguyenvong}}<br>
                                                Khả năng: {{mail.value.khanang}}<br>
                                                Hạn chế: {{mail.value.hanche}}<br>
                                                Trạng thái: <span ng-if="mail.value.trangthai==0">Gia sư chưa trả lời</span>
                                                            <span ng-if="mail.value.trangthai==1">Gia sư đã đồng ý</span>
                                                            <span ng-if="mail.value.trangthai==2">Gia sư không đồng ý</span>
                                                <hr class="uk-divider-icon" style="color: #576683">
                                                <h4>Thông tin gia sư:</h4> <br>
                                                Họ tên: {{mail.tutor.hoten}}<br>
                                                Địa chỉ: {{mail.tutor.diachi}}<br>
                                                Số điện thoại: {{mail.tutor.sdt}}
                                            </p>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <pagination ng-hide="mailOrSent"
                        boundary-links="true"
                        max-size="3"
                        items-per-page="itemsMailPerpage"
                        total-items="sentmails.length"
                        ng-model="currentPage"
                        ng-change="pageChanged(sentmails, itemsMailPerpage, 3)">
                    </pagination>
                    <!-- end sent mail -->
                </div>

            </div><!--/tab-pane-->
             <div class="tab-pane" id="settings">
              <hr>
              <div class="info-item box P30 bg-7 corner">

                    <form  id="registrationForm" name="contact_form" class="info-form noPadding" ng-submit="updateProfileStudent(current_user)" ng-init="loadProfileStudent(current_user)">

                        <div class="col-md-12">
                            <label class="col-md-3 col-xs-12" style="text-align: left ">Tên đầy đủ</label>
                            <span class="col-md-9 col-xs-12"><input type="text"  ng-model="yourProfile.fullname" /></span>
                        </div>

                        <div>
                            <label class="col-md-3 col-xs-12" style="text-align: left ">Số điện thoại</label>
                            <label class="col-md-9 col-xs-12"><input type="text"   ng-model="yourProfile.phone" /></label>
                        </div>

                        <div>
                            <label class="col-md-3 col-xs-12" style="text-align: left ">
                            Nơi học
                            </label>
                            <label class="col-md-9 col-xs-12">
                                <select ng-model="yourProfile.noihoc" style="color: black">
                                  <option value="Tại nhà gia sư">Tại nhà gia sư</option>
                                  <option value="Tại nhà học sinh">Tại nhà học sinh</option>
                                  <option value="Khác">Khác</option>
                                </select>
                            </label>
                        </div>

                        <div class="col-md-12">
                            <label class="col-md-3 col-xs-12" style="text-align: left ">Địa chỉ</label>
                            <span class="col-md-9 col-xs-12"><input type="text" ng-model="yourProfile.diachi" /></span>
                        </div>

                        <div class="col-md-12">
                            <label>Châm ngôn sống</label>
                            <textarea ng-model="yourProfile.quote">{{yourProfile.quote}}</textarea>
                        </div>

                        <div class="col-md-12">
                            <label>Mô tả bản thân</label>
                            <textarea ng-model="yourProfile.descr">{{yourProfile.descr}}</textarea>
                        </div>

                        <div class="col-md-12">
                            <label class="col-md-3 col-xs-12">Môn học đã chọn</label>
                            <span>
                                <label  ng-repeat='sub in yourProfile.mon'>
                                    <ng-letter-avatar charCount="2" data="{{sub}}"></ng-letter-avatar>
                                </label>
                            </span>
                        </div>

                        <div class="col-md-12" ng-init="loadCategorySubject()">
                            <label class="col-md-3 col-xs-12">Thêm môn học</label>
                            <span>
                                <select  style="color: black">
                                  <option value="x[$index].loaimon" ng-repeat='x in allCategorySubject'>{{x.loaimon}}</option>
                                </select>
                            </span>
                        </div>


                        <button  class="small base-text-color" type="submit" id="sbmt">Cập nhật</button>

                    </form>
                </div>
             </div><!--/tab-pane-->

              <div class="tab-pane" id="accounts">
              <hr>
                <div class="info-item box P30 bg-7 corner">

                    <form name="accountForm" class="info-form" ng-submit="updateAccountStudent(current_user)" ng-init="loadAccountStudent(current_user)">

                        <label>Email</label>
                        <input type="text" placeholder="Please Enter Your Email" name="mail"  ng-model="user.email" required />
                        <div role="alert">
                          <span class="error" ng-show="accountForm.mail.$error.required">
                            Đừng bỏ trống bạn ơi!</span>
                        </div>

                        <label>Mật khẩu hiện tại</label>
                        <input type="password" name="pass"  ng-model="user.oldpassword" />

                        <label>Mật khẩu mới</label>
                        <input type="password" name="pass"  ng-model="user.newpassword" />

                        <label>Xác nhận mật khẩu</label>
                        <input type="password"  name="confirmpass" ng-model="user.confirmpass"  />

                        <div ng-show="accountForm.pass.$viewValue != '' && (accountForm.pass.$viewValue != accountForm.confirmpass.$viewValue)">Mật khẩu không trùng khớp!</div>

                        <button  class="small base-text-color" type="submit" id="sbmt" ng-disabled=" accountForm.mail.$error.required || accountForm.pass.$viewValue != '' && accountForm.pass.$viewValue != accountForm.confirmpass.$viewValue">Cập nhật</button>

                    </form>
                </div>
              </div><!--/tab-pane-->

              <div class="tab-pane" id="avatar" ng-controller="TutorProfileController">
              <hr>
                    <div>
                        <img class="mythumbnail" ng-src="/upload/{{user.avatar}}" ng-hide="thumbnail.dataUrl">
                        <div ng-if="thumbnail.dataUrl">
                            <img class="mythumbnail" ng-src="{{thumbnail.dataUrl}}">
                        </div>
                    </div>
                    <form  class="form-horizontal info-form" id="editProfile" name="editAcc" ng-submit=uploadAvatar()>
                        <input type="hidden" ng-model="user._id" name="userid">
                        <div class="form-group">
                            <label class="control-label col-sm-2" for="avatar">Your photo:</label>
                            <div class="col-sm-6">
                                <input type="file" id="avatar" file-model="user.avatar" name="myfile" ng-disabled="uploading"onchange="angular.element(this).scope().photoChange(this.files)" required>
                            </div>
                            <div class="col-sm-3">
                                <button type="submit" class="base-text-color" style="padding-top: 0px; margin-top: 0px" ng-disabled="uploading">Upload</button>
                            </div>
                        </div>
                        <div ng-show="message">
                            <div ng-class="alert">{{message}}</div>
                        </div>
                    </form>
              </div><!--/tab-pane-->

<!-- tab danh sách học sinh -->
                <div class="tab-pane" id="danhsachHocsinh">
                    <div class="list-group-item text-muted">Danh sách học sinh tham gia lớp của gia sư <b>{{lophoc.giasu.hoten}}</b></div>
                        <div class="padding">
                            <div class="row row-sm">
                                <div class="col-xs-12 col-md-6 uk-inline" ng-repeat="x in danhsachHS">
                                    <div class="list-item r m-b tutor" >
                                        <a herf="#" class="list-left">
                                            <span class="w-40 avatar">
                                                <img ng-src="/upload/{{x.user.avatar}}" ng-hide="thumbnail.dataUrl">
                                                <div ng-if="thumbnail.dataUrl">
                                                    <img ng-src="{{thumbnail.dataUrl}}">
                                                </div>
                                            </span>
                                        </a>
                                        <div class="list-body">
                                            <div class="text-ellipsis">
                                            <a style="text-transform: uppercase;">{{x.hocsinh.fullname}}
                                                <span>
                                                    <a ng-if="x.hocsinh.username != current_user" class="glyphicon glyphicon-comment pull-right" href="#chat-hocsinh" uk-toggle="target: #chat-hocsinh" ng-click="loadChat(x.hocsinh.username)" title="Chat với học sinh" uk-tooltip></a>
                                                </span>
                                                <span>
                                                    <a class="glyphicon glyphicon-eye-open pull-right" href="#modal-full-student" ng-click="viewStudent(x)" uk-toggle title="Xem thông tin chi tiết học sinh" uk-tooltip>
                                                    </a>
                                                </span>

                                            </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
<!-- Khung chat với học sinh -->
                        <div id="chat-hocsinh" uk-offcanvas="flip: true" >
                            <div class="uk-offcanvas-bar">
                                <div >
                                    <div>
                                        <div class="panel-heading">
                                            <span class="glyphicon glyphicon-comment"></span> Chat
                                        </div>
                                        <div class="panel-body chatbody">
                                            <ul class="chat">
                                                <li class="left clearfix" ng-repeat="chatMessage in chatMessages" >
                                                    <!-- nếu bằng current_user định dạng bên trái ngược lại bên phải -->
                                                    <div class="chat-body clearfix" ng-if="chatMessage.name==current_user">
                                                        <div class="header">
                                                            <strong class="primary-font uk-label uk-label-success">{{chatMessage.name}}</strong> <small class="pull-right text-muted">
                                                                <span class="glyphicon glyphicon-time"></span>{{chatMessage.createdAt | date: 'yyyy-MM-dd'}}</small>
                                                        </div>
                                                        <p>
                                                            {{chatMessage.message}}
                                                        </p>
                                                    </div>
                                                    <div class="chat-body clearfix" ng-if="chatMessage.name!=current_user">
                                                        <div class="header">
                                                            <small class=" text-muted"><span class="glyphicon glyphicon-time"></span>{{chatMessage.createdAt | date: 'yyyy-MM-dd'}}</small>
                                                            <strong class="pull-right primary-font uk-label uk-label-danger">{{chatMessage.name}}</strong>
                                                        </div>
                                                        <p>
                                                            {{chatMessage.message}}
                                                        </p>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="panel-footer">
                                            <div class="input-group">
                                                <input id="btn-input" type="text" class="form-control input-sm" ng-model="chatMes" placeholder="Type your message here..." />
                                                <span class="input-group-btn">
                                                    <button ng-click="sendChat()" class="btn btn-warning btn-sm" id="btn-chat">
                                                        Send</button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button class="uk-button uk-button-default uk-offcanvas-close uk-width-1-1 uk-margin" type="button">Close</button>

                            </div>
                        </div>
                    </div>
                </div><!--/tab-pane-->

          </div><!--/tab-content-->

        </div><!--/col-9-->
        </div>
    </div>
    <!-- option  đăng nhu cầu học-->
    <div id="offcanvas-push" uk-offcanvas="mode: push; overlay: true" >
        <div class="uk-offcanvas-bar uk-offcanvas-bar-animation uk-offcanvas-push margform" >

            <h3 style="text-align: center;">Đăng nhu cầu học</h3>
            <hr class="uk-divider-icon">
           <form name="nhucauform" ng-controller="StudentController" ng-submit="feedbackSubject(current_user,yourSubject)" ng-init="load()">
                <fieldset ui:sortable class="uk-fieldset">
                    <div role="alert">
                      <span class="error" ng-show="nhucauform.subject.$error.required && nhucauform.altsubject.$error.required">
                        Vui lòng chọn môn muốn đăng feedback!</span>
                    </div>
                    <div class="uk-margin marginput">
                        <div class="uk-inline"  >
                            <h4>Chọn Môn Học</h4>

                            <p uk-overflow-auto>
                                <label style="width: 100%;color: #fff" ng-repeat='sub in subject'>
                                    <ng-letter-avatar charCount="2" data="{{sub.tenmon}}"></ng-letter-avatar>
                                    <input class="uk-radio" type="radio" name="subject" ng-model="$parent.yourSubject" ng-value="sub.tenmon"> {{sub.tenmon}}
                                </label>
                            </p>
                        <!-- <ng-letter-avatar data="{{feedback}}" ng-model="feedbackSubject.feedback"></ng-letter-avatar>{{feedback}} -->
                        </div>
                    </div>
                    <h4>Không tìm thấy môn</h4>
                    <p>
                        <input style="color:#fff" placeholder="Nhập môn nếu bạn không tìm thấy" type="text" name="altsubject" ng-model="feedback.newsubject">
                    </p>
                    <p>Xin đảm bảo môn bạn vừa nhập hợp lệ. Nếu qui phạm tài khoản của bạn có thể bị khóa.</p>

                </fieldset>
                <br>
                <button class="uk-button uk-button-primary" type="submit" style="color:black" ng-disabled="nhucauform.subject.$error.required && nhucauform.altsubject.$error.required">Send</button>
            </form>

        </div>
    </div>

    <!-- cập nhật môn học và vị trí học -->
    <div id="updatePro" uk-offcanvas="mode: push; overlay: true" >
        <div class="uk-offcanvas-bar uk-offcanvas-bar-animation uk-offcanvas-push margform" >

            <h3 style="text-align: center;">Cập nhật thông tin môn học</h3>
            <hr class="uk-divider-icon">
           <form name="nhucauform" ng-controller="StudentController" ng-submit="">
                <fieldset ui:sortable class="uk-fieldset">
                    <div role="alert">
                      <span class="error" ng-show="nhucauform.subject.$error.required && nhucauform.altsubject.$error.required">
                        Vui lòng chọn môn muốn đăng feedback! Cảm ơn</span>
                    </div>
                    <div class="uk-margin marginput">
                        <div class="uk-inline"  >
                            <h4>Môn học bạn đã đăng kí trước đó</h4>

                            <span ng-init="loadSubProfile()"></span>

                            <p uk-overflow-auto>
                                <label style="width: 100%;color: #fff" ng-repeat='sub in subject'>
                                    <ng-letter-avatar data="{{sub.tenmon}}"></ng-letter-avatar>
                                    <input class="uk-radio" type="radio" name="subject" ng-model="$parent.yourSubject" ng-value="sub.tenmon"> {{sub.tenmon}}
                                </label>
                            </p>
                        <!-- <ng-letter-avatar data="{{feedback}}" ng-model="feedbackSubject.feedback"></ng-letter-avatar>{{feedback}} -->
                        </div>
                    </div>
                    <h4>Not found subjects</h4>
                    <p>
                        <input style="color:#fff" placeholder="Please enter your subject" type="text" name="altsubject" ng-model="feedback.newsubject">
                    </p>

                </fieldset>
                <br>
                <button type="submit" style="color:#fff" ng-disabled="nhucauform.subject.$error.required && nhucauform.altsubject.$error.required">Send</button>
            </form>

        </div>
    </div>
</section>



<script type="text/javascript">
    // $(document).on("click", "#modal-prompt", function(e) {
    //     e.preventDefault();
    //         $(this).blur();
    //         UIkit.modal.prompt('Điểm', 'Nhập số điểm đánh giá').then(function(name) {
    //             console.log('Prompted:', name);
    //         });
    //     });
</script>

<!-- open mail -->
<!-- common functions -->
<script src="assets/plugin/mailbox/js/common.min.js"></script>
<!-- altair common functions/helpers -->
<script src="assets/plugin/mailbox/js/altair_admin_common.min.js"></script>

 <!-- mailbox functions -->
<script src="assets/plugin/mailbox/js/pages/page_mailbox.min.js"></script>
